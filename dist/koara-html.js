(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.koaraHtml = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
module.exports = require('./lib/koara-html');

},{"./lib/koara-html":2}],2:[function(require,module,exports){
"use strict";

var used = [],
    exports = module.exports = {};

exports.Html5Renderer = require("./koara/html/html5renderer");

},{"./koara/html/html5renderer":3}],3:[function(require,module,exports){
"use strict";

function Html5Renderer() {
	this.out = "";
}

Html5Renderer.prototype = {
	constructor: Html5Renderer,
	partial: true,

	visitDocument: function(node) {
		this.out = "";
		this.level = 0;
		this.listSequence = [];
		this.hardWrap = false;
		node.childrenAccept(this);
	},

	visitHeading: function(node) {
		this.indent();
		this.out += "<h" + 	node.value + ">";
		node.childrenAccept(this);
		this.out += "</h" + node.value + ">\n";
		if (!node.isNested()) {
            this.out += "\n";
        }
	},

	visitBlockQuote: function(node) {
		this.indent();
		this.out += "<blockquote>";
		if (node.children && node.children.length > 0) {
            this.out += "\n";
		}
        this.level++;
        node.childrenAccept(this);
        this.level--;
        this.indent();
        this.out += "</blockquote>\n";
        if (!node.isNested()) {
           this.out += "\n";
        }
	},

	visitListBlock: function(node) {
		this.listSequence.push(0);
		var tag = node.ordered ? "ol" : "ul";

		this.indent();
		this.out += "<" + tag + ">\n";
		this.level++;
		node.childrenAccept(this);
		this.level--;
		this.indent();
		this.out += "</" + tag + ">\n";
		if (!node.isNested()) {
            this.out += "\n";
		}
		this.listSequence.pop();
	},

	visitListItem: function(node) {
		var seq = Number(this.listSequence[this.listSequence.length - 1]) + 1;

		this.listSequence[this.listSequence.length - 1] = seq;

		this.indent();
        this.out += "<li";
		if (node.number && (seq !== Number(node.number))) {
			this.out += " value=\"" + node.number + "\"";
			this.listSequence.push(node.number);
		}
		this.out += ">";
		if (node.children && node.children.length > 0) {
			var block = (node.children[0].constructor.name === "Paragraph" || node.children[0].constructor.name === "BlockElement");

			if (node.children.length > 1 || !block) {
                this.out += "\n";
            }
			this.level++;
			node.childrenAccept(this);
			this.level--;
			if (node.children.length > 1 || !block) {
				this.indent();
			}
		}
		this.out += "</li>\n";
	},

	visitCodeBlock: function(node) {
		this.indent();
		this.out += "<pre><code";
		if (node.language) {
			this.out += " class=\"language-" + this.escape(node.language) + "\"";
		}
		this.out += ">";
		this.out += this.escape(node.value) + "</code></pre>\n";
		if (!node.isNested()) {
            this.out += "\n";
        }
	},

	visitParagraph: function(node) {
		if (node.isNested() && (node.parent.constructor.name === "ListItem") && node.isSingleChild()) {
			node.childrenAccept(this);
		} else {
			this.indent();
			this.out += "<p>";
			node.childrenAccept(this);
			this.out += "</p>\n";

			if (!node.isNested()) {
				this.out += "\n";
			}
		}
	},

	visitBlockElement: function(node) {
		if (node.isNested() && (node.parent.constructor.name === "ListItem") && node.isSingleChild()) {
			node.childrenAccept(this);
		} else {
			this.indent();
			node.childrenAccept(this);
			if (!node.isNested()) {
				this.out += "\n";
			}
		}
	},

	visitImage: function(node) {
		this.out += "<img src=\"" + this.escapeUrl(node.value) + "\" alt=\"";
		node.childrenAccept(this);
		this.out += "\" />";
	},

	visitLink: function(node) {
		this.out += "<a href=\"" + this.escapeUrl(node.value.toString()) + "\">";
		node.childrenAccept(this);
		this.out += "</a>";
	},

	visitStrong: function(node) {
		this.out += "<strong>";
		node.childrenAccept(this);
		this.out += "</strong>";
	},

	visitEm: function(node) {
		this.out += "<em>";
		node.childrenAccept(this);
		this.out += "</em>";
	},

	visitCode: function(node) {
		this.out += "<code>";
		node.childrenAccept(this);
		this.out += "</code>";
	},

	visitText: function(node) {
		this.out += this.escape(node.value);
	},

	visitLineBreak: function(node) {
		if(this.hardWrap || node.explicit) {
			this.out += "<br>";
		}
		this.out += "\n";
		this.indent();
		node.childrenAccept(this);
	},

	escapeUrl: function(text) {
        return text.replace(/ /gm, "%20").
            replace(/\"/gm, "%22").
            replace(/`/gm, "%60").
            replace(/</gm, "%3C").
            replace(/>/gm, "%3E").
            replace(/\[/gm, "%5B").
            replace(/\]/gm, "%5D").
            replace(/\\/gm, "%5C");
	},

	indent: function() {
		var repeat = this.level * 2;

		for (var i = repeat - 1; i >= 0; i--) {
			this.out += " ";
		}
	},

	escape: function(text) {
		return text.replace(/&/gm, "&amp;").
            replace(/</gm, "&lt;").
            replace(/>/gm, "&gt;").
            replace(/\"/gm, "&quot;");
	},

	getOutput: function() {
		if (!this.partial) {
			var wrapper = "<!DOCTYPE html>\n";

			wrapper += "<html>\n";
			wrapper += "  <body>\n";
			wrapper += this.out.trim().replace(/^/, "    ") + "\n";
			wrapper += "  </body>\n";
			wrapper += "</html>\n";
			return wrapper;
		}
        return this.out.trim();
	}

};

module.exports = Html5Renderer;

},{}]},{},[1])(1)
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvVXNlcnMvYW5keS9naXQva29hcmEva29hcmEtanMtaHRtbC9pbmRleC5qcyIsIi9Vc2Vycy9hbmR5L2dpdC9rb2FyYS9rb2FyYS1qcy1odG1sL2xpYi9rb2FyYS1odG1sLmpzIiwiL1VzZXJzL2FuZHkvZ2l0L2tvYXJhL2tvYXJhLWpzLWh0bWwvbGliL2tvYXJhL2h0bWwvaHRtbDVyZW5kZXJlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBLE1BQU0sQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDLGtCQUFrQixDQUFDOzs7QUNBNUMsWUFBWSxDQUFDOztBQUViLElBQUksSUFBSSxHQUFHLEVBQUU7QUFDYixJQUFJLE9BQU8sR0FBRyxNQUFNLENBQUMsT0FBTyxHQUFHLEVBQUUsQ0FBQzs7QUFFbEMsT0FBTyxDQUFDLGFBQWEsR0FBRyxPQUFPLENBQUMsNEJBQTRCLENBQUMsQ0FBQzs7O0FDTDlELFlBQVksQ0FBQzs7QUFFYixTQUFTLGFBQWEsR0FBRztDQUN4QixJQUFJLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQztBQUNmLENBQUM7O0FBRUQsYUFBYSxDQUFDLFNBQVMsR0FBRztDQUN6QixXQUFXLEVBQUUsYUFBYTtBQUMzQixDQUFDLE9BQU8sRUFBRSxJQUFJOztDQUViLGFBQWEsRUFBRSxTQUFTLElBQUksRUFBRTtFQUM3QixJQUFJLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQztFQUNkLElBQUksQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDO0VBQ2YsSUFBSSxDQUFDLFlBQVksR0FBRyxFQUFFLENBQUM7RUFDdkIsSUFBSSxDQUFDLFFBQVEsR0FBRyxLQUFLLENBQUM7RUFDdEIsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUM1QixFQUFFOztDQUVELFlBQVksRUFBRSxTQUFTLElBQUksRUFBRTtF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RTVCLEtBQUssSUFBSSxDQUFDLEdBQUcsTUFBTSxHQUFHLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFO0dBQ3JDLElBQUksQ0FBQyxHQUFHLElBQUksR0FBRyxDQUFDO0dBQ2hCO0FBQ0gsRUFBRTs7Q0FFRCxNQUFNLEVBQUUsU0FBUyxJQUFJLEVBQUU7RUFDdEIsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxPQUFPLENBQUM7WUFDekIsT0FBTyxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUM7WUFDdEIsT0FBTyxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUM7WUFDdEIsT0FBTyxDQUFDLE1BQU0sRUFBRSxRQUFRLENBQUMsQ0FBQztBQUN0QyxFQUFFOztDQUVELFNBQVMsRUFBRSxXQUFXO0VBQ3JCLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFO0FBQ3JCLEdBQUcsSUFBSSxPQUFPLEdBQUcsbUJBQW1CLENBQUM7O0dBRWxDLE9BQU8sSUFBSSxVQUFVLENBQUM7R0FDdEIsT0FBTyxJQUFJLFlBQVksQ0FBQztHQUN4QixPQUFPLElBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxHQUFHLElBQUksQ0FBQztHQUN2RCxPQUFPLElBQUksYUFBYSxDQUFDO0dBQ3pCLE9BQU8sSUFBSSxXQUFXLENBQUM7R0FDdkIsT0FBTyxPQUFPLENBQUM7R0FDZjtRQUNLLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQztBQUMvQixFQUFFOztBQUVGLENBQUMsQ0FBQzs7QUFFRixNQUFNLENBQUMsT0FBTyxHQUFHLGFBQWEsQ0FBQztBQUMvQiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vbGliL2tvYXJhLWh0bWwnKTsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIHVzZWQgPSBbXSxcbiAgICBleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcblxuZXhwb3J0cy5IdG1sNVJlbmRlcmVyID0gcmVxdWlyZShcIi4va29hcmEvaHRtbC9odG1sNXJlbmRlcmVyXCIpO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIEh0bWw1UmVuZGVyZXIoKSB7XG5cdHRoaXMub3V0ID0gXCJcIjtcbn1cblxuSHRtbDVSZW5kZXJlci5wcm90b3R5cGUgPSB7XG5cdGNvbnN0cnVjdG9yOiBIdG1sNVJlbmRlcmVyLFxuXHRwYXJ0aWFsOiB0cnVlLFxuXG5cdHZpc2l0RG9jdW1lbnQ6IGZ1bmN0aW9uKG5vZGUpIHtcblx0XHR0aGlzLm91dCA9IFwiXCI7XG5cdFx0dGhpcy5sZXZlbCA9IDA7XG5cdFx0dGhpcy5saXN0U2VxdWVuY2UgPSBbXTtcblx0XHR0aGlzLmhhcmRXcmFwID0gZmFsc2U7XG5cdFx0bm9kZS5jaGlsZHJlbkFjY2VwdCh0aGlzKTtcblx0fSxcblxuXHR2aXNpdEhlYWRpbmc6IGZ1bmN0aW9uKG5vZGUpIHtcblx0XHR0aGlzLmluZGVudCgpO1xuXHRcdHRoaXMub3V0ICs9IFwiPGhcIiArIFx0bm9kZS52YWx1ZSArIFwiPlwiO1xuXHRcdG5vZGUuY2hpbGRyZW5BY2NlcHQodGhpcyk7XG5cdFx0dGhpcy5vdXQgKz0gXCI8L2hcIiArIG5vZGUudmFsdWUgKyBcIj5cXG5cIjtcblx0XHRpZiAoIW5vZGUuaXNOZXN0ZWQoKSkge1xuICAgICAgICAgICAgdGhpcy5vdXQgKz0gXCJcXG5cIjtcbiAgICAgICAgfVxuXHR9LFxuXG5cdHZpc2l0QmxvY2tRdW90ZTogZnVuY3Rpb24obm9kZSkge1xuXHRcdHRoaXMuaW5kZW50KCk7XG5cdFx0dGhpcy5vdXQgKz0gXCI8YmxvY2txdW90ZT5cIjtcblx0XHRpZiAobm9kZS5jaGlsZHJlbiAmJiBub2RlLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMub3V0ICs9IFwiXFxuXCI7XG5cdFx0fVxuICAgICAgICB0aGlzLmxldmVsKys7XG4gICAgICAgIG5vZGUuY2hpbGRyZW5BY2NlcHQodGhpcyk7XG4gICAgICAgIHRoaXMubGV2ZWwtLTtcbiAgICAgICAgdGhpcy5pbmRlbnQoKTtcbiAgICAgICAgdGhpcy5vdXQgKz0gXCI8L2Jsb2NrcXVvdGU+XFxuXCI7XG4gICAgICAgIGlmICghbm9kZS5pc05lc3RlZCgpKSB7XG4gICAgICAgICAgIHRoaXMub3V0ICs9IFwiXFxuXCI7XG4gICAgICAgIH1cblx0fSxcblxuXHR2aXNpdExpc3RCbG9jazogZnVuY3Rpb24obm9kZSkge1xuXHRcdHRoaXMubGlzdFNlcXVlbmNlLnB1c2goMCk7XG5cdFx0dmFyIHRhZyA9IG5vZGUub3JkZXJlZCA/IFwib2xcIiA6IFwidWxcIjtcblxuXHRcdHRoaXMuaW5kZW50KCk7XG5cdFx0dGhpcy5vdXQgKz0gXCI8XCIgKyB0YWcgKyBcIj5cXG5cIjtcblx0XHR0aGlzLmxldmVsKys7XG5cdFx0bm9kZS5jaGlsZHJlbkFjY2VwdCh0aGlzKTtcblx0XHR0aGlzLmxldmVsLS07XG5cdFx0dGhpcy5pbmRlbnQoKTtcblx0XHR0aGlzLm91dCArPSBcIjwvXCIgKyB0YWcgKyBcIj5cXG5cIjtcblx0XHRpZiAoIW5vZGUuaXNOZXN0ZWQoKSkge1xuICAgICAgICAgICAgdGhpcy5vdXQgKz0gXCJcXG5cIjtcblx0XHR9XG5cdFx0dGhpcy5saXN0U2VxdWVuY2UucG9wKCk7XG5cdH0sXG5cblx0dmlzaXRMaXN0SXRlbTogZnVuY3Rpb24obm9kZSkge1xuXHRcdHZhciBzZXEgPSBOdW1iZXIodGhpcy5saXN0U2VxdWVuY2VbdGhpcy5saXN0U2VxdWVuY2UubGVuZ3RoIC0gMV0pICsgMTtcblxuXHRcdHRoaXMubGlzdFNlcXVlbmNlW3RoaXMubGlzdFNlcXVlbmNlLmxlbmd0aCAtIDFdID0gc2VxO1xuXG5cdFx0dGhpcy5pbmRlbnQoKTtcbiAgICAgICAgdGhpcy5vdXQgKz0gXCI8bGlcIjtcblx0XHRpZiAobm9kZS5udW1iZXIgJiYgKHNlcSAhPT0gTnVtYmVyKG5vZGUubnVtYmVyKSkpIHtcblx0XHRcdHRoaXMub3V0ICs9IFwiIHZhbHVlPVxcXCJcIiArIG5vZGUubnVtYmVyICsgXCJcXFwiXCI7XG5cdFx0XHR0aGlzLmxpc3RTZXF1ZW5jZS5wdXNoKG5vZGUubnVtYmVyKTtcblx0XHR9XG5cdFx0dGhpcy5vdXQgKz0gXCI+XCI7XG5cdFx0aWYgKG5vZGUuY2hpbGRyZW4gJiYgbm9kZS5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XG5cdFx0XHR2YXIgYmxvY2sgPSAobm9kZS5jaGlsZHJlblswXS5jb25zdHJ1Y3Rvci5uYW1lID09PSBcIlBhcmFncmFwaFwiIHx8IG5vZGUuY2hpbGRyZW5bMF0uY29uc3RydWN0b3IubmFtZSA9PT0gXCJCbG9ja0VsZW1lbnRcIik7XG5cblx0XHRcdGlmIChub2RlLmNoaWxkcmVuLmxlbmd0aCA+IDEgfHwgIWJsb2NrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vdXQgKz0gXCJcXG5cIjtcbiAgICAgICAgICAgIH1cblx0XHRcdHRoaXMubGV2ZWwrKztcblx0XHRcdG5vZGUuY2hpbGRyZW5BY2NlcHQodGhpcyk7XG5cdFx0XHR0aGlzLmxldmVsLS07XG5cdFx0XHRpZiAobm9kZS5jaGlsZHJlbi5sZW5ndGggPiAxIHx8ICFibG9jaykge1xuXHRcdFx0XHR0aGlzLmluZGVudCgpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHR0aGlzLm91dCArPSBcIjwvbGk+XFxuXCI7XG5cdH0sXG5cblx0dmlzaXRDb2RlQmxvY2s6IGZ1bmN0aW9uKG5vZGUpIHtcblx0XHR0aGlzLmluZGVudCgpO1xuXHRcdHRoaXMub3V0ICs9IFwiPHByZT48Y29kZVwiO1xuXHRcdGlmIChub2RlLmxhbmd1YWdlKSB7XG5cdFx0XHR0aGlzLm91dCArPSBcIiBjbGFzcz1cXFwibGFuZ3VhZ2UtXCIgKyB0aGlzLmVzY2FwZShub2RlLmxhbmd1YWdlKSArIFwiXFxcIlwiO1xuXHRcdH1cblx0XHR0aGlzLm91dCArPSBcIj5cIjtcblx0XHR0aGlzLm91dCArPSB0aGlzLmVzY2FwZShub2RlLnZhbHVlKSArIFwiPC9jb2RlPjwvcHJlPlxcblwiO1xuXHRcdGlmICghbm9kZS5pc05lc3RlZCgpKSB7XG4gICAgICAgICAgICB0aGlzLm91dCArPSBcIlxcblwiO1xuICAgICAgICB9XG5cdH0sXG5cblx0dmlzaXRQYXJhZ3JhcGg6IGZ1bmN0aW9uKG5vZGUpIHtcblx0XHRpZiAobm9kZS5pc05lc3RlZCgpICYmIChub2RlLnBhcmVudC5jb25zdHJ1Y3Rvci5uYW1lID09PSBcIkxpc3RJdGVtXCIpICYmIG5vZGUuaXNTaW5nbGVDaGlsZCgpKSB7XG5cdFx0XHRub2RlLmNoaWxkcmVuQWNjZXB0KHRoaXMpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmluZGVudCgpO1xuXHRcdFx0dGhpcy5vdXQgKz0gXCI8cD5cIjtcblx0XHRcdG5vZGUuY2hpbGRyZW5BY2NlcHQodGhpcyk7XG5cdFx0XHR0aGlzLm91dCArPSBcIjwvcD5cXG5cIjtcblxuXHRcdFx0aWYgKCFub2RlLmlzTmVzdGVkKCkpIHtcblx0XHRcdFx0dGhpcy5vdXQgKz0gXCJcXG5cIjtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0dmlzaXRCbG9ja0VsZW1lbnQ6IGZ1bmN0aW9uKG5vZGUpIHtcblx0XHRpZiAobm9kZS5pc05lc3RlZCgpICYmIChub2RlLnBhcmVudC5jb25zdHJ1Y3Rvci5uYW1lID09PSBcIkxpc3RJdGVtXCIpICYmIG5vZGUuaXNTaW5nbGVDaGlsZCgpKSB7XG5cdFx0XHRub2RlLmNoaWxkcmVuQWNjZXB0KHRoaXMpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmluZGVudCgpO1xuXHRcdFx0bm9kZS5jaGlsZHJlbkFjY2VwdCh0aGlzKTtcblx0XHRcdGlmICghbm9kZS5pc05lc3RlZCgpKSB7XG5cdFx0XHRcdHRoaXMub3V0ICs9IFwiXFxuXCI7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdHZpc2l0SW1hZ2U6IGZ1bmN0aW9uKG5vZGUpIHtcblx0XHR0aGlzLm91dCArPSBcIjxpbWcgc3JjPVxcXCJcIiArIHRoaXMuZXNjYXBlVXJsKG5vZGUudmFsdWUpICsgXCJcXFwiIGFsdD1cXFwiXCI7XG5cdFx0bm9kZS5jaGlsZHJlbkFjY2VwdCh0aGlzKTtcblx0XHR0aGlzLm91dCArPSBcIlxcXCIgLz5cIjtcblx0fSxcblxuXHR2aXNpdExpbms6IGZ1bmN0aW9uKG5vZGUpIHtcblx0XHR0aGlzLm91dCArPSBcIjxhIGhyZWY9XFxcIlwiICsgdGhpcy5lc2NhcGVVcmwobm9kZS52YWx1ZS50b1N0cmluZygpKSArIFwiXFxcIj5cIjtcblx0XHRub2RlLmNoaWxkcmVuQWNjZXB0KHRoaXMpO1xuXHRcdHRoaXMub3V0ICs9IFwiPC9hPlwiO1xuXHR9LFxuXG5cdHZpc2l0U3Ryb25nOiBmdW5jdGlvbihub2RlKSB7XG5cdFx0dGhpcy5vdXQgKz0gXCI8c3Ryb25nPlwiO1xuXHRcdG5vZGUuY2hpbGRyZW5BY2NlcHQodGhpcyk7XG5cdFx0dGhpcy5vdXQgKz0gXCI8L3N0cm9uZz5cIjtcblx0fSxcblxuXHR2aXNpdEVtOiBmdW5jdGlvbihub2RlKSB7XG5cdFx0dGhpcy5vdXQgKz0gXCI8ZW0+XCI7XG5cdFx0bm9kZS5jaGlsZHJlbkFjY2VwdCh0aGlzKTtcblx0XHR0aGlzLm91dCArPSBcIjwvZW0+XCI7XG5cdH0sXG5cblx0dmlzaXRDb2RlOiBmdW5jdGlvbihub2RlKSB7XG5cdFx0dGhpcy5vdXQgKz0gXCI8Y29kZT5cIjtcblx0XHRub2RlLmNoaWxkcmVuQWNjZXB0KHRoaXMpO1xuXHRcdHRoaXMub3V0ICs9IFwiPC9jb2RlPlwiO1xuXHR9LFxuXG5cdHZpc2l0VGV4dDogZnVuY3Rpb24obm9kZSkge1xuXHRcdHRoaXMub3V0ICs9IHRoaXMuZXNjYXBlKG5vZGUudmFsdWUpO1xuXHR9LFxuXG5cdHZpc2l0TGluZUJyZWFrOiBmdW5jdGlvbihub2RlKSB7XG5cdFx0aWYodGhpcy5oYXJkV3JhcCB8fCBub2RlLmV4cGxpY2l0KSB7XG5cdFx0XHR0aGlzLm91dCArPSBcIjxicj5cIjtcblx0XHR9XG5cdFx0dGhpcy5vdXQgKz0gXCJcXG5cIjtcblx0XHR0aGlzLmluZGVudCgpO1xuXHRcdG5vZGUuY2hpbGRyZW5BY2NlcHQodGhpcyk7XG5cdH0sXG5cblx0ZXNjYXBlVXJsOiBmdW5jdGlvbih0ZXh0KSB7XG4gICAgICAgIHJldHVybiB0ZXh0LnJlcGxhY2UoLyAvZ20sIFwiJTIwXCIpLlxuICAgICAgICAgICAgcmVwbGFjZSgvXFxcIi9nbSwgXCIlMjJcIikuXG4gICAgICAgICAgICByZXBsYWNlKC9gL2dtLCBcIiU2MFwiKS5cbiAgICAgICAgICAgIHJlcGxhY2UoLzwvZ20sIFwiJTNDXCIpLlxuICAgICAgICAgICAgcmVwbGFjZSgvPi9nbSwgXCIlM0VcIikuXG4gICAgICAgICAgICByZXBsYWNlKC9cXFsvZ20sIFwiJTVCXCIpLlxuICAgICAgICAgICAgcmVwbGFjZSgvXFxdL2dtLCBcIiU1RFwiKS5cbiAgICAgICAgICAgIHJlcGxhY2UoL1xcXFwvZ20sIFwiJTVDXCIpO1xuXHR9LFxuXG5cdGluZGVudDogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHJlcGVhdCA9IHRoaXMubGV2ZWwgKiAyO1xuXG5cdFx0Zm9yICh2YXIgaSA9IHJlcGVhdCAtIDE7IGkgPj0gMDsgaS0tKSB7XG5cdFx0XHR0aGlzLm91dCArPSBcIiBcIjtcblx0XHR9XG5cdH0sXG5cblx0ZXNjYXBlOiBmdW5jdGlvbih0ZXh0KSB7XG5cdFx0cmV0dXJuIHRleHQucmVwbGFjZSgvJi9nbSwgXCImYW1wO1wiKS5cbiAgICAgICAgICAgIHJlcGxhY2UoLzwvZ20sIFwiJmx0O1wiKS5cbiAgICAgICAgICAgIHJlcGxhY2UoLz4vZ20sIFwiJmd0O1wiKS5cbiAgICAgICAgICAgIHJlcGxhY2UoL1xcXCIvZ20sIFwiJnF1b3Q7XCIpO1xuXHR9LFxuXG5cdGdldE91dHB1dDogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCF0aGlzLnBhcnRpYWwpIHtcblx0XHRcdHZhciB3cmFwcGVyID0gXCI8IURPQ1RZUEUgaHRtbD5cXG5cIjtcblxuXHRcdFx0d3JhcHBlciArPSBcIjxodG1sPlxcblwiO1xuXHRcdFx0d3JhcHBlciArPSBcIiAgPGJvZHk+XFxuXCI7XG5cdFx0XHR3cmFwcGVyICs9IHRoaXMub3V0LnRyaW0oKS5yZXBsYWNlKC9eLywgXCIgICAgXCIpICsgXCJcXG5cIjtcblx0XHRcdHdyYXBwZXIgKz0gXCIgIDwvYm9keT5cXG5cIjtcblx0XHRcdHdyYXBwZXIgKz0gXCI8L2h0bWw+XFxuXCI7XG5cdFx0XHRyZXR1cm4gd3JhcHBlcjtcblx0XHR9XG4gICAgICAgIHJldHVybiB0aGlzLm91dC50cmltKCk7XG5cdH1cblxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBIdG1sNVJlbmRlcmVyO1xuXG5cbiJdfQ==
